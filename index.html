<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>S-01 Kundenverwaltung</title>
  <style>
    :root { --bg: #f7f9fc; --card: #ffffff; --border: #e5e7eb; --text: #1f2937; --muted: #4b5563; --general: #1f2937; --p1: #4f46e5; --p2: #059669; --p3: #f59e0b; --p4: #e11d48; }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: 'Segoe UI', Tahoma, sans-serif; background: radial-gradient(circle at 20% 20%, #f2f5ff 0%, #f7f9fc 35%, #eef2ff 100%); color: var(--text); }
    .page { min-height: 100vh; padding: 32px; }
    .container { max-width: 1400px; margin: 0 auto; display: grid; gap: 24px; }
    .card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; box-shadow: 0 10px 40px rgba(15, 23, 42, 0.08); padding: 24px; }
    h1 { margin: 0 0 8px 0; font-size: 28px; }
    h2 { margin: 0 0 12px 0; font-size: 20px; }
    p.lead { margin: 0; color: var(--muted); font-size: 14px; line-height: 1.6; }
    .header-info { background: linear-gradient(135deg, rgba(79, 70, 229, 0.06), rgba(5, 150, 105, 0.06)); border-left: 4px solid var(--p1); padding: 16px; border-radius: 12px; margin-top: 16px; }
    .legend { display: flex; flex-wrap: wrap; gap: 12px; margin-top: 16px; }
    .legend-item { display: flex; align-items: center; gap: 8px; font-size: 14px; color: var(--text); }
    .pill { height: 10px; width: 40px; border-radius: 999px; border: 1px solid rgba(0,0,0,0.08); }
    .p1 { background: var(--p1); color: #fff; border-color: #312e81; }
    .p2 { background: var(--p2); color: #fff; border-color: #065f46; }
    .p3 { background: var(--p3); color: #111827; border-color: #d97706; }
    .p4 { background: var(--p4); color: #fff; border-color: #9f1239; }
    .general { background: #1f2937; color: #fff; border-color: #0f172a; }
    
    /* Horizontal Layout für Hauptäste */
    .branches-container { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
    .branch-column { background: var(--card); border: 2px solid var(--border); border-radius: 16px; padding: 20px; box-shadow: 0 6px 24px rgba(0,0,0,0.06); }
    .branch-header { padding: 14px 18px; border-radius: 12px; margin-bottom: 16px; cursor: pointer; transition: transform 0.2s; }
    .branch-header:hover { transform: translateY(-2px); }
    .branch-title { font-weight: 700; font-size: 18px; margin: 0; }
    .branch-meta { font-size: 12px; margin: 6px 0 0 0; opacity: 0.9; line-height: 1.4; }
    .branch-content { display: none; }
    .branch-content.expanded { display: block; }
    
    /* Node-Styles für Kinder */
    .node-wrap { margin-left: 0; margin-bottom: 12px; }
    .node { display: flex; align-items: flex-start; gap: 10px; }
    .node-box { padding: 10px 14px; border-radius: 12px; border: 2px solid transparent; box-shadow: 0 4px 16px rgba(0,0,0,0.06); }
    .node-title { font-weight: 600; line-height: 1.3; font-size: 14px; }
    .node-meta { margin: 4px 0 0 0; font-size: 11px; opacity: 0.85; line-height: 1.4; }
    .children { border-left: 2px solid var(--border); margin-left: 18px; padding-left: 16px; margin-top: 8px; }
    .toggle { cursor: pointer; border: none; background: transparent; font-size: 14px; line-height: 1; padding: 4px; color: var(--muted); }
    .bullet { width: 6px; height: 6px; border-radius: 50%; background: #9ca3af; margin-top: 8px; flex-shrink: 0; }
    
    /* Bubble-Auflistung */
    .task-bubbles { display: flex; flex-wrap: wrap; gap: 10px; }
    .task-bubble { padding: 10px 16px; border-radius: 20px; font-size: 13px; font-weight: 500; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; border: 2px solid transparent; }
    .task-bubble:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.12); }
    
    /* Timeline horizontal */
    .timeline-horizontal { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px; }
    .timeline-week { background: var(--card); border: 2px solid var(--border); border-radius: 16px; padding: 16px; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; }
    .timeline-week:hover { transform: translateY(-4px); box-shadow: 0 8px 32px rgba(0,0,0,0.12); }
    .timeline-week-header { padding: 12px 16px; border-radius: 12px; margin-bottom: 12px; }
    .timeline-week-title { font-weight: 700; font-size: 16px; margin: 0 0 6px 0; }
    .timeline-week-info { font-size: 13px; line-height: 1.5; opacity: 0.9; margin: 0; }
    .timeline-week-tasks { display: none; flex-direction: column; gap: 8px; margin-top: 12px; }
    .timeline-week-tasks.expanded { display: flex; }
    .timeline-kw50 .timeline-week-header { background: linear-gradient(135deg, rgba(34, 197, 94, 0.08), rgba(34, 197, 94, 0.04)); border-left: 3px solid #86efac; }
    .timeline-kw51 .timeline-week-header { background: linear-gradient(135deg, rgba(34, 197, 94, 0.14), rgba(34, 197, 94, 0.07)); border-left: 3px solid #4ade80; }
    .timeline-kw52 .timeline-week-header { background: linear-gradient(135deg, rgba(34, 197, 94, 0.20), rgba(34, 197, 94, 0.10)); border-left: 3px solid #22c55e; }
    .timeline-kw01 .timeline-week-header { background: linear-gradient(135deg, rgba(34, 197, 94, 0.26), rgba(34, 197, 94, 0.13)); border-left: 3px solid #16a34a; }
    .timeline-kw02 .timeline-week-header { background: linear-gradient(135deg, rgba(34, 197, 94, 0.32), rgba(34, 197, 94, 0.16)); border-left: 3px solid #15803d; }
    .timeline-kw03 .timeline-week-header { background: linear-gradient(135deg, rgba(34, 197, 94, 0.38), rgba(34, 197, 94, 0.19)); border-left: 3px solid #166534; }
    .timeline-kw04 .timeline-week-header { background: linear-gradient(135deg, rgba(34, 197, 94, 0.44), rgba(34, 197, 94, 0.22)); border-left: 3px solid #14532d; }
    
    @media (max-width: 1200px) {
      .branches-container { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="container">
      <!-- Header Card -->
      <div class="card">
        <h1>S-01 Kundenverwaltung</h1>
        <div class="header-info">
          <p class="lead"><strong>Aufgabenstellung:</strong> Fachliche Gliederung der Anforderungen für das Segment Kundenverwaltung im Online-Ticket-Shop</p>
          <p class="lead"><strong>Pflichtäste:</strong> Use Cases · Objekte und Attribute · Schnittstellen zu anderen Segmenten und externen Systemen</p>
          <p class="lead"><strong>Tools:</strong> Mindmapping mit XMind oder FreeMind · UML-Diagramme mit Visual Paradigm Community Edition</p>
        </div>
        <div class="legend" id="legend"></div>
      </div>

      <!-- Drei Hauptäste horizontal -->
      <div class="branches-container" id="branches"></div>

      <!-- Timeline mit Aufgaben pro Woche -->
      <div class="card">
        <h2>Timeline bis 25.01.2026</h2>
        <div class="timeline-horizontal" id="timeline"></div>
      </div>
    </div>
  </div>
  <script>
    const nodeIndex = new Map();
    const parentIndex = new Map();
    const allTasks = [];
    const roleStyles = { general: 'general', p1: 'p1', p2: 'p2', p3: 'p3', p4: 'p4' };
    const legend = [
      { role: 'general', label: 'Aufgabenstellung / Neutral' },
      { role: 'p1', label: 'Use Cases & Stories' },
      { role: 'p2', label: 'Objekte & Attribute' },
      { role: 'p3', label: 'Dynamik & Regeln' },
      { role: 'p4', label: 'Schnittstellen & Segmente' }
    ];

    const mindMapData = {
      label: 'S-01 Kundenverwaltung',
      role: 'general',
      meta: 'Format: Mindmap; Tools: XMind/FreeMind',
      children: [
        { label: 'Use Cases', role: 'p1', meta: 'Alle Use Cases mit User Stories; Format: User Stories + UC-Spezifikationen; Tools: XMind/FreeMind + Visual Paradigm', children: [
          { label: 'UC: Registrierung & Login', role: 'p1', meta: 'Passwort-Policy, Sperrlogik; Schnittstelle zu S-09; Format: UC-Spezifikation + Aktivitätsdiagramm; Tools: XMind + Visual Paradigm', children: [
            { label: 'User Story: Registrierung', role: 'p1', meta: 'Erstelle in XMind einen Topic-Knoten "User Story: Registrierung" mit Subtopics für Akzeptanzkriterien: Benutzername (unique), E-Mail (validiert), Passwort 2× eingeben (identisch), Registrierungsdatum (automatisch)' },
            { label: 'User Story: Login', role: 'p1', meta: 'Erstelle in XMind einen Topic-Knoten "User Story: Login" mit Subtopics: Eingabe Benutzername/Passwort, 3× falsches Passwort → 1h Sperre, Erfolgreiches Login → Zugriff auf Warenkorb' },
            { label: 'UC-Spezifikation: Registrierung', role: 'p1', meta: 'Erstelle in XMind eine UC-Spezifikation mit Knoten: Vorbedingung (kein Account), Nachbedingung (Account erstellt), Hauptszenario (1. Formular öffnen, 2. Daten eingeben, 3. Passwort 2× eingeben, 4. Bestätigen), Alternativszenarien (E-Mail bereits vorhanden, Passwörter nicht identisch)' },
            { label: 'UC-Spezifikation: Login', role: 'p1', meta: 'Erstelle in XMind eine UC-Spezifikation mit Knoten: Vorbedingung (Account vorhanden, nicht gesperrt), Nachbedingung (eingeloggt), Hauptszenario (1. Benutzername/Passwort eingeben, 2. Validierung mit S-09, 3. Session erstellen), Alternativszenarien (falsches Passwort → Fehlversuch erhöhen, 3. Fehlversuch → Sperre bis Timestamp+1h)' },
            { label: 'Aktivitätsdiagramm: Passwort-Validierung', role: 'p3', meta: 'Öffne Visual Paradigm, erstelle ein neues Activity Diagram. Füge Start-Node hinzu → Action "Passwort eingeben" → Decision-Node "Passwort komplex?" (Guard: Mindestlänge 8, Großbuchstaben, Ziffern, Sonderzeichen) → bei [nein] Action "Fehlermeldung anzeigen" → zurück zu "Passwort eingeben". Bei [ja] → Action "Passwort wiederholen" → Decision-Node "Passwörter identisch?" → bei [nein] zurück zu "Passwort eingeben", bei [ja] → Action "Passwort-Hash speichern" → End-Node' },
            { label: 'Aktivitätsdiagramm: Sperrlogik', role: 'p3', meta: 'Öffne Visual Paradigm, erstelle ein neues Activity Diagram. Start-Node → Action "Login-Versuch" → Aufruf an S-09 "Passwort validieren" → Decision-Node "Passwort korrekt?" → bei [ja] Action "Session erstellen" → End-Node. Bei [nein] → Action "Fehlversuche +1" → Decision-Node "Fehlversuche >= 3?" → bei [ja] Action "Gesperrt-bis = jetzt + 1h setzen" → Action "Fehlermeldung: Account gesperrt" → End-Node. Bei [nein] → Action "Fehlermeldung: falsches Passwort" → zurück zu "Login-Versuch"' },
            { label: 'Sequenzdiagramm: Schnittstelle S-09', role: 'p3', meta: 'Öffne Visual Paradigm, erstelle ein neues Sequence Diagram. Füge Lifelines hinzu: "Kunde", "S-01 Kundenverwaltung", "S-09 Login-System". Zeichne Message von Kunde → S-01 "login(benutzername, passwort)". S-01 → S-09 "validatePassword(benutzername, passwort)". S-09 antwortet mit return "valid/invalid + Fehlversuche". Bei invalid: S-01 → S-09 "incrementFailedAttempts(benutzername)". Bei 3. Fehlversuch: S-01 → S-09 "lockAccount(benutzername, duration=1h)". S-09 return "accountLocked". S-01 → Kunde "Fehlermeldung"' }
          ]},
          { label: 'UC: Profil & Kontaktdaten pflegen', role: 'p1', meta: 'Liefer-/Rechnungsadresse, nur digitale Zustellung (Anforderung für S-04); Format: UC-Spezifikation; Tool: XMind', children: [
            { label: 'User Story: Profil pflegen', role: 'p1', meta: 'Erstelle in XMind einen Topic-Knoten "User Story: Profil pflegen" mit Subtopics: Akzeptanzkriterien (Vorname, Nachname, E-Mail änderbar; Liefer-/Rechnungsadresse separat pflegen; nur digitale Ticket-Zustellung E-Mail/Download/QR-Code, keine Papiertickets)' },
            { label: 'UC-Spezifikation: Profil bearbeiten', role: 'p1', meta: 'Erstelle in XMind eine UC-Spezifikation mit Knoten: Vorbedingung (eingeloggt), Nachbedingung (Daten aktualisiert), Hauptszenario (1. Profil öffnen, 2. Felder bearbeiten: Name, E-Mail, 3. Speichern, 4. Bestätigung), Alternativszenarien (E-Mail bereits vergeben → Fehlermeldung)' },
            { label: 'UC-Spezifikation: Adresse pflegen', role: 'p1', meta: 'Erstelle in XMind eine UC-Spezifikation mit Knoten: Vorbedingung (eingeloggt), Nachbedingung (Adresse gespeichert), Hauptszenario (1. Adresstyp wählen: Liefer- oder Rechnungsadresse, 2. Felder eingeben: Straße, PLZ, Ort, Land, 3. Speichern), Alternativszenarien (PLZ ungültig → Validierung), Hinweis: S-04 nutzt nur digitale Kanäle für Tickets' }
          ]},
          { label: 'UC: Zahlungswege verwalten', role: 'p1', meta: 'Zahlarten hinterlegen; Validierung IBAN/BIC/Luhn/Token; Schnittstelle zu S-03; Format: UC-Spezifikation + Aktivitätsdiagramm; Tools: XMind + Visual Paradigm', children: [
            { label: 'User Story: Zahlungsweg hinzufügen', role: 'p1', meta: 'Erstelle in XMind einen Topic-Knoten "User Story: Zahlungsweg hinzufügen" mit Subtopics: Akzeptanzkriterien (Standardkunde: Vorkasse, Kreditkarte, PayPal, Bankeinzug; Premium-Kunde zusätzlich: Rechnung, Überweisung; alle Zahlungsdaten validiert vor Speicherung)' },
            { label: 'UC-Spezifikation: Zahlungsweg anlegen', role: 'p1', meta: 'Erstelle in XMind eine UC-Spezifikation mit Knoten: Vorbedingung (eingeloggt), Nachbedingung (Zahlungsweg gespeichert), Hauptszenario (1. Zahlart wählen, 2. Daten eingeben: IBAN/BIC für Bankeinzug, Kartennummer/CVV für Kreditkarte, PayPal-ID, 3. Validierung durchführen, 4. Speichern), Alternativszenarien (IBAN ungültig → Fehlermeldung, Luhn-Check fehlgeschlagen)' },
            { label: 'Aktivitätsdiagramm: IBAN-Validierung', role: 'p3', meta: 'Öffne Visual Paradigm, erstelle ein neues Activity Diagram. Start-Node → Action "IBAN eingeben" → Action "Ländercode prüfen (DE: 22 Zeichen)" → Decision-Node "Länge korrekt?" → bei [nein] Action "Fehlermeldung" → zurück. Bei [ja] → Action "Prüfziffer berechnen (Modulo 97)" → Decision-Node "Prüfziffer korrekt?" → bei [nein] zurück, bei [ja] → Action "BIC eingeben" → Action "BIC-Format prüfen (8 oder 11 Zeichen)" → Decision-Node "BIC korrekt?" → bei [ja] Action "IBAN/BIC speichern" → End-Node' },
            { label: 'Aktivitätsdiagramm: Kreditkarten-Validierung (Luhn)', role: 'p3', meta: 'Öffne Visual Paradigm, erstelle ein neues Activity Diagram. Start-Node → Action "Kartennummer eingeben" → Action "Luhn-Algorithmus anwenden (jede 2. Ziffer verdoppeln, Quersumme bilden, Modulo 10 = 0)" → Decision-Node "Luhn-Check bestanden?" → bei [nein] Action "Fehlermeldung: ungültige Kartennummer" → zurück. Bei [ja] → Action "CVV eingeben" → Action "Ablaufdatum prüfen (nicht abgelaufen)" → Decision-Node "Karte gültig?" → bei [nein] zurück, bei [ja] → Action "Kartentoken generieren" → Action "Token speichern (verschlüsselt)" → End-Node' },
            { label: 'Aktivitätsdiagramm: PayPal-Validierung', role: 'p3', meta: 'Öffne Visual Paradigm, erstelle ein neues Activity Diagram. Start-Node → Action "PayPal-E-Mail eingeben" → Action "E-Mail-Format validieren (regex)" → Decision-Node "Format korrekt?" → bei [nein] zurück. Bei [ja] → Action "PayPal-API aufrufen: validateAccount(email)" → Decision-Node "Account existiert?" → bei [nein] Action "Fehlermeldung" → zurück, bei [ja] → Action "PayPal-ID speichern" → End-Node' },
            { label: 'Sequenzdiagramm: Zahlungsweg an S-03 übergeben', role: 'p3', meta: 'Öffne Visual Paradigm, erstelle ein neues Sequence Diagram. Lifelines: "Kunde", "S-01 Kundenverwaltung", "S-03 Bezahlung". Message von Kunde → S-01 "selectPaymentMethod(zahlungsweg)". S-01 → S-03 "processPayment(zahlungsweg-Objekt: {type, IBAN/Token/PayPal-ID})". S-03 validiert und antwortet mit return "paymentApproved" oder "paymentFailed". S-01 → Kunde "Bestätigung/Fehler"' }
          ]},
          { label: 'UC: Premium-Status nutzen', role: 'p1', meta: 'Premium-Upgrade; Reservierungsdauer 2h/4h; Warenkorb-Timeout 24h/36h; Schnittstellen zu S-02, S-06; Format: UC-Spezifikation; Tool: XMind', children: [
            { label: 'User Story: Premium-Upgrade', role: 'p1', meta: 'Erstelle in XMind einen Topic-Knoten "User Story: Premium-Upgrade" mit Subtopics: Akzeptanzkriterien (Upgrade-Button im Profil, Vorteile: Reservierungsdauer 4h statt 2h, Warenkorb-Timeout 36h statt 24h, zusätzliche Zahlarten: Rechnung/Überweisung, Upgrade-Datum speichern)' },
            { label: 'UC-Spezifikation: Premium-Upgrade durchführen', role: 'p1', meta: 'Erstelle in XMind eine UC-Spezifikation mit Knoten: Vorbedingung (Standardkunde, eingeloggt), Nachbedingung (Premium-Status aktiv, Upgrade-Datum gesetzt), Hauptszenario (1. Premium-Upgrade anfordern, 2. Vorteile anzeigen, 3. Bestätigen, 4. Status auf "Premium" setzen, 5. Upgrade-Datum speichern), Alternativszenarien (bereits Premium → Meldung "bereits Premium-Kunde")' },
            { label: 'Sequenzdiagramm: Reservierungsdauer an S-02 übergeben', role: 'p3', meta: 'Öffne Visual Paradigm, erstelle ein neues Sequence Diagram. Lifelines: "Kunde", "S-01 Kundenverwaltung", "S-02 Sitzplatzauswahl". Message von Kunde → S-01 "requestReservation()". S-01 liest Kundenstatus → Alt-Fragment [Standardkunde] S-01 → S-02 "reserve(dauer=2h)", [Premium-Kunde] S-01 → S-02 "reserve(dauer=4h)". S-02 return "reservationConfirmed". S-01 → Kunde "Reservierung bestätigt"' },
            { label: 'Sequenzdiagramm: Warenkorb-Timeout an S-06 übergeben', role: 'p3', meta: 'Öffne Visual Paradigm, erstelle ein neues Sequence Diagram. Lifelines: "Kunde", "S-01 Kundenverwaltung", "S-06 Warenkorb". Message von Kunde → S-01 "addToCart(artikel)". S-01 liest Kundenstatus → Alt-Fragment [Standardkunde] S-01 → S-06 "addItem(artikel, timeout=24h)", [Premium-Kunde] S-01 → S-06 "addItem(artikel, timeout=36h)". S-06 return "itemAdded". S-01 → Kunde "Artikel in Warenkorb"' }
          ]},
          { label: 'UC: Artikel bewerten', role: 'p1', meta: 'Bewertung nur für gekaufte Artikel nach Terminende; Schnittstelle zu S-05; Format: UC-Spezifikation + Aktivitätsdiagramm; Tools: XMind + Visual Paradigm', children: [
            { label: 'User Story: Artikel bewerten', role: 'p1', meta: 'Erstelle in XMind einen Topic-Knoten "User Story: Artikel bewerten" mit Subtopics: Akzeptanzkriterien (nur gekaufte Artikel bewertbar, erst nach Terminende, Bewertung 1-5 Sterne + optionaler Kommentar, Shop selbst nicht bewertbar)' },
            { label: 'UC-Spezifikation: Bewertung abgeben', role: 'p1', meta: 'Erstelle in XMind eine UC-Spezifikation mit Knoten: Vorbedingung (eingeloggt, Artikel gekauft, Termin beendet), Nachbedingung (Bewertung gespeichert), Hauptszenario (1. Kaufhistorie öffnen, 2. Artikel auswählen, 3. Sterne-Bewertung abgeben 1-5, 4. Optional Kommentar eingeben, 5. Speichern), Alternativszenarien (Artikel nicht gekauft → Fehler, Termin noch nicht beendet → Fehler, Shop als Artikel → ausgeschlossen)' },
            { label: 'Aktivitätsdiagramm: Bewertungsberechtigung prüfen', role: 'p3', meta: 'Öffne Visual Paradigm, erstelle ein neues Activity Diagram. Start-Node → Action "Bewertung anfordern" → Action "Kaufhistorie abrufen" → Decision-Node "Artikel in Kaufhistorie?" → bei [nein] Action "Fehlermeldung: Artikel nicht gekauft" → End-Node. Bei [ja] → Action "Termindatum abrufen" → Decision-Node "Termin beendet (Datum < jetzt)?" → bei [nein] Action "Fehlermeldung: Termin noch nicht vorbei" → End-Node. Bei [ja] → Decision-Node "Artikel = Shop?" → bei [ja] Action "Fehlermeldung: Shop nicht bewertbar" → End-Node. Bei [nein] → Action "Bewertungsformular anzeigen" → End-Node' },
            { label: 'Sequenzdiagramm: Bewertung an S-05 übergeben', role: 'p3', meta: 'Öffne Visual Paradigm, erstelle ein neues Sequence Diagram. Lifelines: "Kunde", "S-01 Kundenverwaltung", "S-05 Kundenbewertung". Message von Kunde → S-01 "submitRating(artikel-ID, bewertung, kommentar)". S-01 → S-01 selbst: "validatePurchase(kunde-ID, artikel-ID)" (prüft Kaufhistorie). S-01 → S-01: "validateEventDate(artikel-ID)" (prüft Termin beendet). Alt-Fragment [berechtigt] S-01 → S-05 "storeRating(kunde-ID, artikel-ID, bewertung, kommentar, datum)". S-05 return "ratingStored". S-01 → Kunde "Bewertung gespeichert". [nicht berechtigt] S-01 → Kunde "Fehlermeldung: nicht berechtigt"' }
          ]}
        ]},
        { label: 'Objekte und Attribute', role: 'p2', meta: 'Klassendiagramm, Datenstruktur, Ableitungen; Format: UML-Klassendiagramm; Tool: Visual Paradigm', children: [
          { label: 'Kunde (zentral)', role: 'p2', meta: 'Basis-Entity mit Ableitungen Standard/Premium; Format: UML-Klassendiagramm (Vererbung); Tool: Visual Paradigm', children: [
            { label: 'Klasse "Kunde" erstellen', role: 'p2', meta: 'Öffne Visual Paradigm, erstelle ein neues Class Diagram. Füge eine Klasse "Kunde" hinzu (Rechteck mit drei Abschnitten). Klicke im ersten Abschnitt (Klassenname) und benenne sie "Kunde". Setze Stereotype auf <<entity>>' },
            { label: 'Attribute hinzufügen: Basis-Daten', role: 'p2', meta: 'Klicke im zweiten Abschnitt der Klasse "Kunde" und füge folgende Attribute hinzu (Format: "-attribut: Typ"): -kundennummer: String {NOT NULL, UNIQUE}, -benutzername: String {NOT NULL, UNIQUE}, -email: String {NOT NULL, UNIQUE}, -vorname: String {NOT NULL}, -nachname: String {NOT NULL}, -registrierungsdatum: Date {NOT NULL}, -status: Enum(Standard, Premium) {NOT NULL}' },
            { label: 'Attribute hinzufügen: Login-Daten', role: 'p2', meta: 'Füge der Klasse "Kunde" weitere Attribute hinzu: -passwortHash: String {NOT NULL, encrypted}, -fehlversuche: int {default=0}, -gesperrtBis: DateTime {nullable}. Diese Attribute werden für Schnittstelle zu S-09 (Login-System) benötigt' },
            { label: 'Vererbung: Standardkunde', role: 'p2', meta: 'Erstelle eine neue Klasse "Standardkunde" im Visual Paradigm Class Diagram. Wähle das Generalization-Tool (hohler Pfeil) und zeichne eine Vererbungslinie von "Standardkunde" zu "Kunde" (Pfeil zeigt auf "Kunde"). "Standardkunde" erbt alle Attribute von "Kunde", keine zusätzlichen Attribute nötig' },
            { label: 'Vererbung: Premium-Kunde', role: 'p2', meta: 'Erstelle eine neue Klasse "PremiumKunde" im Visual Paradigm Class Diagram. Zeichne eine Generalization-Linie von "PremiumKunde" zu "Kunde". Füge der Klasse "PremiumKunde" ein zusätzliches Attribut hinzu: -upgradeDatum: Date {NOT NULL}. Notiere in einem Kommentar: "Vorteile: Reservierung 4h, Warenkorb-Timeout 36h, Zahlarten: Rechnung/Überweisung"' }
          ]},
          { label: 'Adresse', role: 'p2', meta: 'Trennung Liefer-/Rechnungsadresse; Format: UML-Klassendiagramm (Aggregation); Tool: Visual Paradigm', children: [
            { label: 'Klasse "Adresse" erstellen', role: 'p2', meta: 'Füge im Visual Paradigm Class Diagram eine neue Klasse "Adresse" hinzu. Setze Stereotype auf <<entity>>. Füge Attribute hinzu: -adressID: String {NOT NULL, UNIQUE, PK}, -strasse: String {NOT NULL}, -hausnummer: String {NOT NULL}, -plz: String {NOT NULL}, -ort: String {NOT NULL}, -land: String {NOT NULL}, -typ: Enum(Lieferadresse, Rechnungsadresse) {NOT NULL}' },
            { label: 'Aggregation: Kunde zu Adresse', role: 'p2', meta: 'Wähle das Association-Tool in Visual Paradigm und zeichne eine Linie von "Kunde" zu "Adresse". Klicke auf die Linie, wähle "Aggregation" (hohle Raute auf Kunde-Seite). Setze Multiplizität: Kunde-Seite "1", Adresse-Seite "0..*" (ein Kunde kann mehrere Adressen haben). Benenne die Association "hat"' }
          ]},
          { label: 'Zahlungsweg', role: 'p2', meta: 'Basis-Entity mit Ableitungen pro Zahlungsart; Format: UML-Klassendiagramm (Vererbung); Tool: Visual Paradigm', children: [
            { label: 'Klasse "Zahlungsweg" erstellen (abstrakt)', role: 'p2', meta: 'Füge im Visual Paradigm Class Diagram eine neue Klasse "Zahlungsweg" hinzu. Setze sie auf abstract (im Properties-Fenster: "Is Abstract" aktivieren, Klassenname wird kursiv). Füge Attribute hinzu: -zahlungswegID: String {NOT NULL, UNIQUE, PK}, -kundeID: String {NOT NULL, FK zu Kunde}, -typ: Enum(Vorkasse, Kreditkarte, PayPal, Bankeinzug, Rechnung, Überweisung) {NOT NULL}' },
            { label: 'Vererbung: Vorkasse', role: 'p2', meta: 'Erstelle eine Klasse "Vorkasse" und zeichne Generalization zu "Zahlungsweg". Füge Attribut hinzu: -ueberweisungskonto: String {NOT NULL} (Konto für Vorkasse-Überweisung)' },
            { label: 'Vererbung: Kreditkarte', role: 'p2', meta: 'Erstelle eine Klasse "Kreditkarte" und zeichne Generalization zu "Zahlungsweg". Füge Attribute hinzu: -kartentoken: String {NOT NULL, UNIQUE, encrypted}, -ablaufdatum: Date {NOT NULL}, -kartentyp: Enum(Visa, MasterCard, Amex) {NOT NULL}. Notiere Constraint: "Luhn-Validierung erforderlich"' },
            { label: 'Vererbung: PayPal', role: 'p2', meta: 'Erstelle eine Klasse "PayPal" und zeichne Generalization zu "Zahlungsweg". Füge Attribut hinzu: -paypalID: String {NOT NULL, UNIQUE} (E-Mail oder PayPal-ID)' },
            { label: 'Vererbung: Bankeinzug', role: 'p2', meta: 'Erstelle eine Klasse "Bankeinzug" und zeichne Generalization zu "Zahlungsweg". Füge Attribute hinzu: -iban: String {NOT NULL, encrypted}, -bic: String {NOT NULL}, -mandatsreferenz: String {NOT NULL, UNIQUE}, -mandatsdatum: Date {NOT NULL}. Notiere Constraint: "IBAN-Validierung (Modulo 97)"' },
            { label: 'Vererbung: Rechnung (nur Premium)', role: 'p2', meta: 'Erstelle eine Klasse "Rechnung" und zeichne Generalization zu "Zahlungsweg". Füge Attribut hinzu: -rechnungsadresseID: String {NOT NULL, FK zu Adresse}. Notiere Constraint: "nur für Premium-Kunden verfügbar"' },
            { label: 'Aggregation: Kunde zu Zahlungsweg', role: 'p2', meta: 'Zeichne eine Aggregation (hohle Raute) von "Kunde" zu "Zahlungsweg". Multiplizität: Kunde "1", Zahlungsweg "0..*" (ein Kunde kann mehrere Zahlungswege haben). Benenne die Association "besitzt"' }
          ]},
          { label: 'Reservierungsparameter', role: 'p2', meta: 'Abgeleitet aus Kundenstatus; Format: UML-Klassendiagramm; Tool: Visual Paradigm', children: [
            { label: 'Methode in Kunde: getReservierungsdauer()', role: 'p2', meta: 'Füge in der Klasse "Kunde" im dritten Abschnitt (Operationen) eine Methode hinzu: +getReservierungsdauer(): int. Notiere in einem Kommentar: "Standardkunde: return 2 (Stunden), Premium-Kunde: return 4 (Stunden). Wird an S-02 Sitzplatzauswahl übergeben"' },
            { label: 'Methode in Kunde: getWarenkorbTimeout()', role: 'p2', meta: 'Füge in der Klasse "Kunde" eine weitere Methode hinzu: +getWarenkorbTimeout(): int. Notiere in einem Kommentar: "Standardkunde: return 24 (Stunden), Premium-Kunde: return 36 (Stunden). Wird an S-06 Warenkorb übergeben"' }
          ]},
          { label: 'Kaufhistorie', role: 'p2', meta: 'Nachweis für Bewertungsberechtigung; Aggregation Kunde → Käufe; Format: UML-Klassendiagramm; Tool: Visual Paradigm', children: [
            { label: 'Klasse "Kauf" erstellen', role: 'p2', meta: 'Füge im Visual Paradigm Class Diagram eine neue Klasse "Kauf" hinzu. Setze Stereotype auf <<entity>>. Füge Attribute hinzu: -kaufID: String {NOT NULL, UNIQUE, PK}, -kundeID: String {NOT NULL, FK zu Kunde}, -kaufdatum: DateTime {NOT NULL}, -artikelID: String {NOT NULL}, -terminID: String {NOT NULL}, -termindatum: DateTime {NOT NULL}, -status: Enum(abgeschlossen, laufend) {NOT NULL}' },
            { label: 'Aggregation: Kunde zu Kauf', role: 'p2', meta: 'Zeichne eine Aggregation (hohle Raute) von "Kunde" zu "Kauf". Multiplizität: Kunde "1", Kauf "0..*" (ein Kunde kann mehrere Käufe haben). Benenne die Association "hat getätigt". Notiere: "wird für Bewertungs-Guard verwendet (prüft ob Artikel gekauft und Termin beendet)"' }
          ]},
          { label: 'Bewertung', role: 'p2', meta: 'Kundenbewertung für gekaufte Artikel; Aggregation Kunde → Bewertungen; Format: UML-Klassendiagramm; Tool: Visual Paradigm', children: [
            { label: 'Klasse "Bewertung" erstellen', role: 'p2', meta: 'Füge im Visual Paradigm Class Diagram eine neue Klasse "Bewertung" hinzu. Setze Stereotype auf <<entity>>. Füge Attribute hinzu: -bewertungID: String {NOT NULL, UNIQUE, PK}, -kundeID: String {NOT NULL, FK zu Kunde}, -artikelID: String {NOT NULL}, -bewertung: int {NOT NULL, range 1-5}, -kommentar: String {nullable, maxLength=500}, -datum: DateTime {NOT NULL}' },
            { label: 'Aggregation: Kunde zu Bewertung', role: 'p2', meta: 'Zeichne eine Aggregation (hohle Raute) von "Kunde" zu "Bewertung". Multiplizität: Kunde "1", Bewertung "0..*". Benenne die Association "verfasst"' },
            { label: 'Constraint: Bewertungsberechtigung', role: 'p2', meta: 'Füge einen Constraint-Kommentar zur Klasse "Bewertung" hinzu (rechte Maustaste auf Klasse → Add → Note): "Constraints: 1. Artikel muss in Kaufhistorie des Kunden vorhanden sein, 2. Termindatum muss in Vergangenheit liegen, 3. Artikel darf nicht vom Typ \'Shop\' sein (Shop nicht bewertbar), 4. Wird an S-05 Kundenbewertung übergeben"' }
          ]}
        ]},
        { label: 'Schnittstellen zu anderen Segmenten und externen Systemen', role: 'p4', meta: 'Übersicht Schnittstellenaufrufe; Format: Sequenzdiagramme; Tool: Visual Paradigm', children: [
          { label: 'S-02 Sitzplatzauswahl', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Sequenzdiagramm: Reservierungsdauer übergeben', role: 'p4', meta: 'Öffne Visual Paradigm, erstelle ein neues Sequence Diagram "S-01 zu S-02: Reservierungsdauer". Füge Lifelines hinzu: "Kunde", "S-01 Kundenverwaltung", "S-02 Sitzplatzauswahl". Zeichne Messages: 1. Kunde → S-01 "reserveSeat(veranstaltungID, sitzplatzID)", 2. S-01 ruft intern "kunde.getReservierungsdauer()" auf (self-call), 3. Alt-Fragment [Standardkunde] S-01 → S-02 "reserve(veranstaltungID, sitzplatzID, dauer=2h)", [Premium-Kunde] S-01 → S-02 "reserve(veranstaltungID, sitzplatzID, dauer=4h)", 4. S-02 return "reservationConfirmed(reservierungID)", 5. S-01 → Kunde "Reservierung bestätigt"' }
          ]},
          { label: 'S-03 Bezahlung', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Sequenzdiagramm: Zahlungsweg-Objekt übergeben', role: 'p4', meta: 'Öffne Visual Paradigm, erstelle ein neues Sequence Diagram "S-01 zu S-03: Zahlungsweg". Füge Lifelines hinzu: "Kunde", "S-01 Kundenverwaltung", "S-03 Bezahlung". Zeichne Messages: 1. Kunde → S-01 "checkout(warenkorbID, zahlungswegID)", 2. S-01 ruft "getZahlungsweg(zahlungswegID)" auf (liest Zahlungsweg-Objekt aus DB), 3. S-01 → S-03 "processPayment(zahlungswegObjekt: {typ, iban/token/paypalID, betrag})", 4. Alt-Fragment [Kreditkarte] S-03 nutzt kartentoken, [Bankeinzug] S-03 nutzt iban/bic/mandatsreferenz, [PayPal] S-03 nutzt paypalID, 5. S-03 return "paymentApproved(transaktionsID)" oder "paymentFailed(fehler)", 6. S-01 → Kunde "Zahlung bestätigt/fehlgeschlagen"' }
          ]},
          { label: 'S-04 Ticketbereitstellung', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Sequenzdiagramm: Digitale Zustellung erzwingen', role: 'p4', meta: 'Öffne Visual Paradigm, erstelle ein neues Sequence Diagram "S-01 zu S-04: Ticket-Zustellung". Füge Lifelines hinzu: "Kunde", "S-01 Kundenverwaltung", "S-04 Ticketbereitstellung". Zeichne Messages: 1. Kunde → S-01 "requestTicketDelivery(kaufID, zustellungsart)", 2. S-01 prüft Constraint "nur digitale Zustellung" (Guard), 3. Alt-Fragment [zustellungsart in {E-Mail, Download, QR-Code}] S-01 → S-04 "deliverTicket(kaufID, zustellungsart, kundeEmail)", S-04 return "ticketDelivered", S-01 → Kunde "Ticket zugestellt". [zustellungsart = Papierticket] S-01 → Kunde "Fehler: Papiertickets nicht verfügbar, nur digitale Zustellung". Notiere Constraint: "S-01 erzwingt: keine Papiertickets"' }
          ]},
          { label: 'S-05 Kundenbewertung', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Sequenzdiagramm: Kaufnachweis prüfen', role: 'p4', meta: 'Öffne Visual Paradigm, erstelle ein neues Sequence Diagram "S-01 zu S-05: Bewertung mit Guard". Füge Lifelines hinzu: "Kunde", "S-01 Kundenverwaltung", "S-05 Kundenbewertung", "Kaufhistorie DB". Zeichne Messages: 1. Kunde → S-01 "submitRating(artikelID, bewertung, kommentar)", 2. S-01 → Kaufhistorie DB "findKauf(kundeID, artikelID)", 3. Kaufhistorie DB return "kauf(kaufID, termindatum, status)", 4. S-01 prüft Guards (self-call): "validatePurchase()" (kauf vorhanden?), "validateEventDate()" (termindatum < jetzt?), "validateArticleType()" (artikelTyp != Shop?), 5. Alt-Fragment [alle Guards erfüllt] S-01 → S-05 "storeRating(kundeID, artikelID, bewertung, kommentar, datum)", S-05 return "ratingStored", S-01 → Kunde "Bewertung gespeichert". [Guard fehlgeschlagen] S-01 → Kunde "Fehler: nicht berechtigt (Artikel nicht gekauft / Termin nicht beendet / Shop nicht bewertbar)"' }
          ]},
          { label: 'S-06 Warenkorb', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Sequenzdiagramm: Warenkorb-Timeout übergeben', role: 'p4', meta: 'Öffne Visual Paradigm, erstelle ein neues Sequence Diagram "S-01 zu S-06: Warenkorb-Timeout". Füge Lifelines hinzu: "Kunde", "S-01 Kundenverwaltung", "S-06 Warenkorb". Zeichne Messages: 1. Kunde → S-01 "addToCart(artikelID)", 2. S-01 ruft intern "kunde.getWarenkorbTimeout()" auf (self-call), 3. Alt-Fragment [Standardkunde] S-01 → S-06 "addItem(kundeID, artikelID, timeout=24h)", [Premium-Kunde] S-01 → S-06 "addItem(kundeID, artikelID, timeout=36h)", 4. S-06 return "itemAdded(warenkorbID)", 5. S-01 → Kunde "Artikel in Warenkorb (gültig bis timestamp + timeout)"' }
          ]},
          { label: 'S-09 Zentrales Login/Passwort-Management', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Sequenzdiagramm: Passwort-Validierung mit Sperre', role: 'p4', meta: 'Öffne Visual Paradigm, erstelle ein neues Sequence Diagram "S-01 zu S-09: Login mit Sperrlogik". Füge Lifelines hinzu: "Kunde", "S-01 Kundenverwaltung", "S-09 Login-System". Zeichne Messages: 1. Kunde → S-01 "login(benutzername, passwort)", 2. S-01 → S-09 "checkAccountLocked(benutzername)", S-09 return "locked=true/false, gesperrtBis", 3. Alt-Fragment [locked=true AND gesperrtBis > jetzt] S-01 → Kunde "Fehler: Account gesperrt bis timestamp", Ende. [nicht gesperrt] S-01 → S-09 "validatePassword(benutzername, passwort)", 4. S-09 prüft Passwort-Hash, return "valid=true/false", 5. Alt-Fragment [valid=true] S-01 → S-09 "resetFailedAttempts(benutzername)", S-01 → Kunde "Login erfolgreich". [valid=false] S-01 → S-09 "incrementFailedAttempts(benutzername)", S-09 return "fehlversuche", 6. Decision: [fehlversuche >= 3] S-01 → S-09 "lockAccount(benutzername, duration=1h)", S-09 setzt gesperrtBis = jetzt + 1h, S-01 → Kunde "Account gesperrt für 1 Stunde". [fehlversuche < 3] S-01 → Kunde "Falsches Passwort, Versuch X von 3"' }
          ]}
        ]}
      ]
    };

    const timelineData = [
      {
        week: 'KW 50',
        period: '09.12–15.12',
        class: 'timeline-kw50',
        description: 'User Stories & UC-Spezifikationen für Registrierung/Login, Profil, Zahlungsarten; Passwort-Policy-Checkliste; erste Aktivitätsdiagramme (Schnittstellen zu S-09, S-03)',
        tasks: [
          { label: 'UC: Registrierung & Login', role: 'p1' },
          { label: 'User Story: Registrierung', role: 'p1' },
          { label: 'User Story: Login', role: 'p1' },
          { label: 'UC-Spezifikation: Registrierung', role: 'p1' },
          { label: 'UC-Spezifikation: Login', role: 'p1' },
          { label: 'Aktivitätsdiagramm: Passwort-Validierung', role: 'p3' },
          { label: 'Aktivitätsdiagramm: Sperrlogik', role: 'p3' },
          { label: 'UC: Profil & Kontaktdaten pflegen', role: 'p1' },
          { label: 'User Story: Profil pflegen', role: 'p1' },
          { label: 'UC-Spezifikation: Profil bearbeiten', role: 'p1' },
          { label: 'UC: Zahlungswege verwalten', role: 'p1' },
          { label: 'User Story: Zahlungsweg hinzufügen', role: 'p1' },
          { label: 'UC-Spezifikation: Zahlungsweg anlegen', role: 'p1' },
          { label: 'Aktivitätsdiagramm: IBAN-Validierung', role: 'p3' },
          { label: 'Aktivitätsdiagramm: Kreditkarten-Validierung (Luhn)', role: 'p3' }
        ]
      },
      {
        week: 'KW 51',
        period: '16.12–22.12',
        class: 'timeline-kw51',
        description: 'Domänenmodell (Kunde, Profil, Zahlungsarten, Berechtigungen, Ableitungen); Attributtabellen/Enums; Review mit Use-Case-Flows',
        tasks: [
          { label: 'Objekte und Attribute', role: 'p2' },
          { label: 'Kunde (zentral)', role: 'p2' },
          { label: 'Klasse "Kunde" erstellen', role: 'p2' },
          { label: 'Attribute hinzufügen: Basis-Daten', role: 'p2' },
          { label: 'Attribute hinzufügen: Login-Daten', role: 'p2' },
          { label: 'Vererbung: Standardkunde', role: 'p2' },
          { label: 'Vererbung: Premium-Kunde', role: 'p2' },
          { label: 'Adresse', role: 'p2' },
          { label: 'Klasse "Adresse" erstellen', role: 'p2' },
          { label: 'Aggregation: Kunde zu Adresse', role: 'p2' },
          { label: 'Zahlungsweg', role: 'p2' },
          { label: 'Klasse "Zahlungsweg" erstellen (abstrakt)', role: 'p2' },
          { label: 'Vererbung: Vorkasse', role: 'p2' },
          { label: 'Vererbung: Kreditkarte', role: 'p2' },
          { label: 'Vererbung: PayPal', role: 'p2' },
          { label: 'Vererbung: Bankeinzug', role: 'p2' },
          { label: 'Vererbung: Rechnung (nur Premium)', role: 'p2' }
        ]
      },
      {
        week: 'KW 52',
        period: '23.12–29.12',
        class: 'timeline-kw52',
        description: 'Dynamik/Regeln ausarbeiten: Sperrlogik, Payment-Validierung, Premium-Upgrade-Folgen, Bewertungs-Guards, digitale Bereitstellung; Aktivitäts-/Sequenzdiagramme',
        tasks: [
          { label: 'Aktivitätsdiagramm: Sperrlogik', role: 'p3' },
          { label: 'Sequenzdiagramm: Schnittstelle S-09', role: 'p3' },
          { label: 'Aktivitätsdiagramm: PayPal-Validierung', role: 'p3' },
          { label: 'Sequenzdiagramm: Zahlungsweg an S-03 übergeben', role: 'p3' },
          { label: 'Sequenzdiagramm: Reservierungsdauer an S-02 übergeben', role: 'p3' },
          { label: 'Sequenzdiagramm: Warenkorb-Timeout an S-06 übergeben', role: 'p3' },
          { label: 'Aktivitätsdiagramm: Bewertungsberechtigung prüfen', role: 'p3' },
          { label: 'Methode in Kunde: getReservierungsdauer()', role: 'p2' },
          { label: 'Methode in Kunde: getWarenkorbTimeout()', role: 'p2' }
        ]
      },
      {
        week: 'KW 01',
        period: '30.12–05.01',
        class: 'timeline-kw01',
        description: 'Schnittstellenverträge zu externen Gruppen S-02/S-03/S-04/S-05/S-06/S-09 inkl. Parameter (Premium-Flag, Reservierungsdauer, Timeouts); Kontextskizze',
        tasks: [
          { label: 'Schnittstellen zu anderen Segmenten und externen Systemen', role: 'p4' },
          { label: 'S-02 Sitzplatzauswahl', role: 'p4' },
          { label: 'Sequenzdiagramm: Reservierungsdauer übergeben', role: 'p4' },
          { label: 'S-03 Bezahlung', role: 'p4' },
          { label: 'Sequenzdiagramm: Zahlungsweg-Objekt übergeben', role: 'p4' },
          { label: 'S-04 Ticketbereitstellung', role: 'p4' },
          { label: 'Sequenzdiagramm: Digitale Zustellung erzwingen', role: 'p4' },
          { label: 'S-05 Kundenbewertung', role: 'p4' },
          { label: 'Sequenzdiagramm: Kaufnachweis prüfen', role: 'p4' },
          { label: 'S-06 Warenkorb', role: 'p4' },
          { label: 'Sequenzdiagramm: Warenkorb-Timeout übergeben', role: 'p4' },
          { label: 'S-09 Zentrales Login/Passwort-Management', role: 'p4' },
          { label: 'Sequenzdiagramm: Passwort-Validierung mit Sperre', role: 'p4' }
        ]
      },
      {
        week: 'KW 02',
        period: '06.01–12.01',
        class: 'timeline-kw02',
        description: 'Konsolidierung: Trace zwischen UCs, Domänenmodell, Regeln, Schnittstellen; Parametertabellen (Reservierung/Warenkorb zu S-02/S-06) finalisieren; Lücken schließen',
        tasks: [
          { label: 'UC: Premium-Status nutzen', role: 'p1' },
          { label: 'User Story: Premium-Upgrade', role: 'p1' },
          { label: 'UC-Spezifikation: Premium-Upgrade durchführen', role: 'p1' },
          { label: 'UC: Artikel bewerten', role: 'p1' },
          { label: 'User Story: Artikel bewerten', role: 'p1' },
          { label: 'UC-Spezifikation: Bewertung abgeben', role: 'p1' },
          { label: 'Kaufhistorie', role: 'p2' },
          { label: 'Klasse "Kauf" erstellen', role: 'p2' },
          { label: 'Aggregation: Kunde zu Kauf', role: 'p2' },
          { label: 'Bewertung', role: 'p2' },
          { label: 'Klasse "Bewertung" erstellen', role: 'p2' },
          { label: 'Constraint: Bewertungsberechtigung', role: 'p2' },
          { label: 'Sequenzdiagramm: Bewertung an S-05 übergeben', role: 'p3' }
        ]
      },
      {
        week: 'KW 03',
        period: '13.01–19.01',
        class: 'timeline-kw03',
        description: 'Qualitätssicherung: Peer-Reviews der Diagramme/Verträge; Konsistenz-Check gegen Vorgaben (S-04 digital only, S-05 Kaufnachweis, S-09 Sperre 3x/1h)',
        tasks: [
          { label: 'UC: Registrierung & Login', role: 'p1' },
          { label: 'UC-Spezifikation: Adresse pflegen', role: 'p1' },
          { label: 'Aggregation: Kunde zu Zahlungsweg', role: 'p2' },
          { label: 'Aggregation: Kunde zu Bewertung', role: 'p2' },
          { label: 'Sequenzdiagramm: Digitale Zustellung erzwingen', role: 'p4' },
          { label: 'Sequenzdiagramm: Kaufnachweis prüfen', role: 'p4' },
          { label: 'Sequenzdiagramm: Passwort-Validierung mit Sperre', role: 'p4' }
        ]
      },
      {
        week: 'KW 04',
        period: '20.01–25.01',
        class: 'timeline-kw04',
        description: 'Finalisierung & Puffer: letzte Anpassungen, Export/Packaging aller Artefakte; Abnahme-Checkliste und Präsentationsfolien erstellen (Ende: 25.01.2026)',
        tasks: [
          { label: 'Use Cases', role: 'p1' },
          { label: 'Objekte und Attribute', role: 'p2' },
          { label: 'Schnittstellen zu anderen Segmenten und externen Systemen', role: 'p4' }
        ]
      }
    ];

    function renderLegend() {
      legend.forEach(item => {
        const el = document.createElement('div');
        el.className = 'legend-item';
        const pill = document.createElement('span');
        pill.className = `pill ${roleStyles[item.role]}`;
        const label = document.createElement('span');
        label.textContent = item.label;
        el.appendChild(pill);
        el.appendChild(label);
        document.getElementById('legend').appendChild(el);
      });
    }

    function collectTasks(node) {
      if (node.label && node.role) {
        allTasks.push({ label: node.label, role: node.role });
      }
      if (node.children) {
        node.children.forEach(child => collectTasks(child));
      }
    }

    function renderBranches() {
      const container = document.getElementById('branches');
      mindMapData.children.forEach(branch => {
        const col = document.createElement('div');
        col.className = 'branch-column';
        
        const header = document.createElement('div');
        header.className = `branch-header ${roleStyles[branch.role]}`;
        header.innerHTML = `<div class="branch-title">${branch.label}</div><div class="branch-meta">${branch.meta || ''}</div>`;
        
        const content = document.createElement('div');
        content.className = 'branch-content';
        
        if (branch.children) {
          branch.children.forEach(child => {
            const childNode = createNode(child, 0, branch.label);
            content.appendChild(childNode);
          });
        }
        
        header.addEventListener('click', () => {
          content.classList.toggle('expanded');
        });
        
        col.appendChild(header);
        col.appendChild(content);
        container.appendChild(col);
        
        nodeIndex.set(branch.label, { toggle: null, childContainer: content });
      });
    }

    function createNode(node, level = 0, parentLabel = null) {
      const wrap = document.createElement('div');
      wrap.className = 'node-wrap';
      const nodeEl = document.createElement('div');
      nodeEl.className = 'node';
      
      let toggle;
      const childContainer = document.createElement('div');
      childContainer.className = 'children';
      childContainer.style.display = 'none';
      
      if (node.children && node.children.length > 0) {
        toggle = document.createElement('button');
        toggle.className = 'toggle';
        toggle.textContent = '▶';
        toggle.addEventListener('click', () => {
          if (childContainer.style.display === 'none') {
            childContainer.style.display = 'block';
            toggle.textContent = '▼';
          } else {
            childContainer.style.display = 'none';
            toggle.textContent = '▶';
          }
        });
        nodeEl.appendChild(toggle);
      } else {
        const bullet = document.createElement('span');
        bullet.className = 'bullet';
        nodeEl.appendChild(bullet);
      }
      
      const boxEl = document.createElement('div');
      boxEl.className = `node-box ${roleStyles[node.role] || 'general'}`;
      const title = document.createElement('div');
      title.className = 'node-title';
      title.textContent = node.label;
      boxEl.appendChild(title);
      if (node.meta) {
        const meta = document.createElement('p');
        meta.className = 'node-meta';
        meta.textContent = node.meta;
        boxEl.appendChild(meta);
      }
      nodeEl.appendChild(boxEl);
      wrap.appendChild(nodeEl);
      
      if (node.children && node.children.length > 0) {
        node.children.forEach(child => {
          const childNode = createNode(child, level + 1, node.label);
          childContainer.appendChild(childNode);
        });
        wrap.appendChild(childContainer);
      }
      
      nodeIndex.set(node.label, { toggle, childContainer });
      if (parentLabel) {
        parentIndex.set(node.label, parentLabel);
      }
      
      return wrap;
    }

    function expandLabel(label) {
      const nodeEntry = nodeIndex.get(label);
      if (!nodeEntry) return;
      
      // Expand parent chain first
      const parentLabel = parentIndex.get(label);
      if (parentLabel) {
        expandLabel(parentLabel);
      }
      
      // Expand branch content if this is a branch label
      if (nodeEntry.childContainer && nodeEntry.toggle === null) {
        if (!nodeEntry.childContainer.classList.contains('expanded')) {
          nodeEntry.childContainer.classList.add('expanded');
        }
        return;
      }
      
      // Expand this node
      if (nodeEntry.toggle && nodeEntry.childContainer) {
        if (nodeEntry.childContainer.style.display === 'none') {
          nodeEntry.childContainer.style.display = 'block';
          nodeEntry.toggle.textContent = '▼';
        }
      }
    }

    function renderTimeline() {
      const container = document.getElementById('timeline');
      timelineData.forEach(weekData => {
        const weekEl = document.createElement('div');
        weekEl.className = `timeline-week ${weekData.class}`;
        
        const header = document.createElement('div');
        header.className = 'timeline-week-header';
        header.innerHTML = `
          <div class="timeline-week-title">${weekData.week} (${weekData.period})</div>
          <p class="timeline-week-info">${weekData.description}</p>
        `;
        
        const tasksContainer = document.createElement('div');
        tasksContainer.className = 'timeline-week-tasks';
        
        weekData.tasks.forEach(task => {
          const bubble = document.createElement('div');
          bubble.className = `task-bubble ${roleStyles[task.role]}`;
          bubble.textContent = task.label;
          bubble.addEventListener('click', (e) => {
            e.stopPropagation();
            expandLabel(task.label);
          });
          tasksContainer.appendChild(bubble);
        });
        
        weekEl.addEventListener('click', () => {
          tasksContainer.classList.toggle('expanded');
        });
        
        weekEl.appendChild(header);
        weekEl.appendChild(tasksContainer);
        container.appendChild(weekEl);
      });
    }

    collectTasks(mindMapData);
    renderLegend();
    renderBranches();
    renderTimeline();
  </script>
</body>
</html>
