<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>S-01 Kundenverwaltung – Mindmap</title>
  <style>
    :root {
      --bg: #f7f9fc;
      --card: #ffffff;
      --border: #e5e7eb;
      --text: #1f2937;
      --muted: #4b5563;
      --general: #1f2937;
      --p1: #4f46e5;
      --p2: #059669;
      --p3: #f59e0b;
      --p4: #e11d48;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: radial-gradient(circle at 20% 20%, #f2f5ff 0%, #f7f9fc 35%, #eef2ff 100%);
      color: var(--text);
    }
    .page {
      min-height: 100vh;
      padding: 32px;
    }
    .container {
      max-width: 1100px;
      margin: 0 auto;
      display: grid;
      gap: 24px;
    }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(15, 23, 42, 0.08);
      padding: 24px;
    }
    h1 { margin: 0 0 8px 0; font-size: 28px; }
    p.lead { margin: 0 0 16px 0; color: var(--muted); }
    .legend { display: flex; flex-wrap: wrap; gap: 12px; }
    .legend-item { display: flex; align-items: center; gap: 8px; font-size: 14px; color: var(--text); }
    .pill { height: 10px; width: 40px; border-radius: 999px; border: 1px solid rgba(0,0,0,0.08); }
    .p1 { background: var(--p1); color: #fff; border-color: #312e81; }
    .p2 { background: var(--p2); color: #fff; border-color: #065f46; }
    .p3 { background: var(--p3); color: #111827; border-color: #d97706; }
    .p4 { background: var(--p4); color: #fff; border-color: #9f1239; }
    .general { background: #1f2937; color: #fff; border-color: #0f172a; }
    .node-wrap { margin-left: 0; }
    .node { display: flex; align-items: flex-start; gap: 10px; margin-bottom: 10px; }
    .node-box {
      padding: 10px 14px;
      border-radius: 12px;
      border: 2px solid transparent;
      box-shadow: 0 6px 24px rgba(0,0,0,0.08);
      max-width: 720px;
    }
    .node-title { font-weight: 700; line-height: 1.2; }
    .node-meta { margin: 4px 0 0 0; font-size: 12px; opacity: 0.9; line-height: 1.4; }
    .children { border-left: 2px solid var(--border); margin-left: 18px; padding-left: 16px; }
    .toggle { cursor: pointer; border: none; background: transparent; font-size: 16px; line-height: 1; padding: 4px; color: var(--muted); }
    .bullet { width: 6px; height: 6px; border-radius: 50%; background: #9ca3af; margin-top: 9px; }
    .hint { font-size: 14px; color: var(--muted); line-height: 1.5; }
    @media (max-width: 720px) {
      .page { padding: 18px; }
      h1 { font-size: 22px; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="container">
      <div class="card">
        <h1>S-01 Kundenverwaltung – Mindmap</h1>
        <p class="lead">Online-Ticket-Shop | Pflichtäste: Use Cases · Objekte und Attribute · Schnittstellen</p>
        <div class="legend" id="legend"></div>
      </div>

      <div class="card" id="mindmap"></div>

      <div class="card">
        <h2 style="margin:0 0 8px 0; font-size:20px;">Hinweis</h2>
        <p class="hint">
          Die Mindmap folgt den geforderten Hauptästen und deckt alle S-01-relevanten Anforderungen ab: Registrierung mit Passwort-Policy und Sperrlogik,
          Profil- und Zahlungsdatenpflege inkl. Premium-Logik, Reservierungs- und Warenkorb-Zeiten, Bewertungsberechtigung, ausschließlich digitale
          Ticketbereitstellung sowie die notwendigen Schnittstellen zu den Segmenten S-02, S-03, S-04, S-05, S-06 und S-09.
        </p>
      </div>
    </div>
  </div>

  <script>
    const roleStyles = {
      general: 'general',
      p1: 'p1',
      p2: 'p2',
      p3: 'p3',
      p4: 'p4'
    };

    const legend = [
      { role: 'general', label: 'Aufgabestellung / Neutral' },
      { role: 'p1', label: 'Person 1 – Use Cases & Stories' },
      { role: 'p2', label: 'Person 2 – Objekte & Attribute' },
      { role: 'p3', label: 'Person 3 – Dynamik & Regeln' },
      { role: 'p4', label: 'Person 4 – Schnittstellen & Segmente' }
    ];

    const mindMapData = {
      label: 'S-01 Kundenverwaltung – Aufgabestellung und Personenverantwortung',
      role: 'general',
      meta: 'Sortiert nach Aufgabenstellung und den Anforderungen pro Person (1–4); Format: Mindmap (HTML/JS); Tool: Browser/VS Code; Vorlesung: VL1 – Einführung & Projektrahmen',
      children: [
        {
          label: 'Aufgabestellung Gesamt',
          role: 'general',
          meta: 'Kernanforderungen S-01: Registrierung, Sicherheit, Premium, Zahlungsdaten, Schnittstellen; Format: Übersichtstext; Tool: Mindmap-Node; Vorlesung: VL2 – Anforderungen & Scope',
          children: [
            { label: 'Registrierung/Login mit Passwort-Policy und Sperre nach 3 Fehlversuchen/1h (S-09)', role: 'general', meta: 'Prof-Vorgabe: Passwortregeln, Doppeleingabe, Sperrlogik implementieren und an Login-Segment koppeln; Format: Policy-Checkliste + Aktivitätsdiagramm; Tool: Markdown + draw.io; Vorlesung: VL9 – Aktivitäts- & Sequenzdiagramme.' },
            { label: 'Digitale Tickets only: E-Mail/Download/QR, keine Papierlieferung (S-04)', role: 'general', meta: 'Nur digitale Bereitstellung modellieren; keine Postwege; Übergabepunkt an Ticketbereitstellung definieren; Format: Architektur-/Kontextnotiz (Text); Tool: Markdown; Vorlesung: VL4 – Geschäftsprozesse & Segmente.' },
            { label: 'Zahlungsarten verwalten inkl. Premium-Rechnung; Validierung IBAN/BIC/Luhn/Token', role: 'general', meta: 'Alle Payment-Flows validieren; Fehlerpfade vorsehen; Premium-Rechnung erst nach Status-Check erlauben; Format: Anforderungstext + Aktivitätsdiagramm Payment; Tool: Markdown + draw.io; Vorlesung: VL10 – Architektur & Schnittstellen.' },
            { label: 'Reservierungsdauer 2h Standard / 4h Premium; Warenkorb-Timeout 24h/36h', role: 'general', meta: 'Parameter an S-02/S-06 weiterreichen; Premium-Flag als Steuergröße in beiden Segmenten nutzen; Format: Parametertabelle; Tool: Markdown/Excel; Vorlesung: VL10 – Architektur & Schnittstellen.' },
            { label: 'Bewertungen nur nach Kauf & Terminende; Kaufnachweis nötig (S-05)', role: 'general', meta: 'Berechtigungsprüfung zentral in S-01 hinterlegen; Terminprüfung und Kaufbeleg an Bewertungssystem liefern; Format: Berechtigungsregel + Aktivitätsdiagramm; Tool: Markdown + draw.io; Vorlesung: VL9 – Aktivitäts- & Sequenzdiagramme.' }
          ]
        },
        {
          label: 'Person 1 – Use Cases & Stories',
          role: 'p1',
          meta: 'Erarbeitet Nutzerziele, Stories und Use-Case-Sicht; Format: Backlog (User Stories) + Use-Case-Spezifikationen (Text); Tool: Markdown/Confluence; Vorlesung: VL3 – Agiles Vorgehen & User Stories',
          children: [
            {
              label: 'Registrierung anlegen',
              role: 'p1',
              children: [
                { label: 'Als Besucher möchte ich mich registrieren, um Tickets kaufen zu können.', role: 'p1', meta: 'Story sauber formulieren, Akteur+Nutzen klar; Akzeptanzkriterien aus Passwortpolicy ableiten.' },
                { label: 'Passwortregeln (Komplexität, doppelte Eingabe); Sperre nach 3 Fehlversuchen', role: 'p3', meta: 'In den UC-Flow aufnehmen; Fehlversuchszähler und Lockout als Schritte modellieren (VL6 UC, VL3 Agile).' }
              ]
            },
            {
              label: 'Anmelden & entsperren',
              role: 'p1',
              children: [
                { label: 'Login für Warenkorb/Käufe nutzen', role: 'p1', meta: 'UC inkl. Preconditions (Account aktiv) und Postconditions (Session offen) beschreiben.' },
                { label: 'Nach Sperrfrist wieder Zugriff erhalten', role: 'p1', meta: 'Flow für Entsperren definieren; Zeitfenster 1h berücksichtigen; alternative Pfade dokumentieren.' }
              ]
            },
            {
              label: 'Profil- und Kontaktdaten pflegen',
              role: 'p1',
              children: [
                { label: 'Liefer- und Rechnungsadresse, Kontaktdaten aktualisieren', role: 'p1', meta: 'UC mit Validierungen (E-Mail-Format, Pflichtfelder) und rein digitalen Zustellwegen formulieren.' }
              ]
            },
            {
              label: 'Zahlungswege verwalten',
              role: 'p1',
              children: [
                { label: 'Zahlungsarten: Vorkasse, Kreditkarte, PayPal, Bankeinzug', role: 'p1', meta: 'UC-Flows pro Zahlart skizzieren; Eingabefehlerpfade aufnehmen.' },
                { label: 'Premium: zusätzlich Rechnung/Überweisung', role: 'p1', meta: 'Premium-Guard in UC verankern; Abhängigkeit zum Status beschreiben.' },
                { label: 'Validierung aller Zahlungsdaten zwingend (IBAN/BIC/Luhn, Token, Mandat)', role: 'p3', meta: 'Akzeptanzkriterien für Validität definieren; Fehler-Responses festlegen.' }
              ]
            },
            {
              label: 'Premium-Status nutzen',
              role: 'p1',
              children: [
                { label: 'Upgrade auf Premium für 4h Reservierung + zusätzliche Zahlungsart', role: 'p1', meta: 'UC mit Trigger, Preconditions (zahlungsfaehig), Postconditions (Status=Premium) beschreiben.' },
                { label: 'Reservierungsdauer an S-02 übergeben; Warenkorb-Timeout nutzt Premium-Flag (S-06)', role: 'p3', meta: 'Schnittstellen-Calls als Schritte im UC aufführen; Parameter benennen.' }
              ]
            },
            {
              label: 'Bewertungsberechtigung prüfen',
              role: 'p1',
              children: [
                { label: 'Bewerten nur für gekaufte Artikel nach Terminende', role: 'p1', meta: 'UC mit Guard „Artikel gekauft + Termin vorbei“; Ausnahmen dokumentieren.' },
                { label: 'System prüft Kaufnachweis und Datum (S-05); Shop-Bewertungen ausgeschlossen', role: 'p3', meta: 'Interaktion mit S-05 als Include/Extend modellieren; Negativpfade beschreiben.' }
              ]
            }
          ]
        },
        {
          label: 'Person 2 – Objekte & Attribute',
          role: 'p2',
          meta: 'Klassendiagramm, Datenstruktur, Ableitungen',
          children: [
            {
              label: 'Kunde (zentral)',
              role: 'p2',
              meta: 'IDs als String; Status & Premium-Flag',
              children: [
                { label: 'kundennr, benutzername, email', role: 'p2', meta: 'IDs als String; Eindeutigkeit für benutzername sicherstellen (VL7/8 UML Klassen).' },
                { label: 'passwortHash, fehlversuche, gesperrtBis', role: 'p2', meta: 'Attribute für Sperrlogik vorsehen; Typen präzisieren (datetime).' },
                { label: 'status: Neu/Aktiv/Gesperrt/Deaktiviert; premium: boolean', role: 'p2', meta: 'Enum definieren; Premium-Flag konsistent zu Ableitungen halten.' }
              ]
            },
            {
              label: 'Kundenprofil',
              role: 'p2',
              children: [
                { label: 'lieferadresse, rechnungsadresse, telefon', role: 'p2', meta: '1:1 zum Kunden; Pflichtfelder markieren; nur digitale Zustellung bedenken.' },
                { label: 'kontaktPraeferenz: Email/Telefon', role: 'p2', meta: 'Enum modellieren; Default Email; Validierung auf erlaubte Werte.' }
              ]
            },
            {
              label: 'Zahlungsart',
              role: 'p2',
              children: [
                { label: 'typ: Vorkasse/Kreditkarte/PayPal/Bankeinzug/RechnungPremium', role: 'p2', meta: 'Enum inkl. Premium-only Wert; Constraints je Typ festhalten.' },
                { label: 'iban, bic, kartenToken, paypalToken', role: 'p2', meta: 'Attribute nur für relevante Typen befüllen; Kardinalitäten dokumentieren.' },
                { label: 'mandatsReferenz, gueltigBis', role: 'p2', meta: 'Für SEPA erfassen; Datumstyp setzen; Pflicht nur bei Bankeinzug.' }
              ]
            },
            {
              label: 'Berechtigung / Historie',
              role: 'p2',
              children: [
                { label: 'gekaufteArtikel: list<string> (Bewertungsrecht)', role: 'p2', meta: 'Liste für Berechtigungsprüfung (S-05); Persistenzform überlegen.' },
                { label: 'letzterLogin, registriertAm', role: 'p2', meta: 'Audit-Attribute; Datentypen präzisieren; optional/null festhalten.' }
              ]
            },
            {
              label: 'Ableitungen',
              role: 'p2',
              children: [
                { label: 'reservierungsdauer(): 2h / 4h je Premium', role: 'p2', meta: 'Operation mit Rückgabetyp Duration modellieren; nutzt premium-Flag.' },
                { label: 'warenkorbTimeout(): 24h / 36h je Premium', role: 'p2', meta: 'Operation für S-06; Werte als Konstante oder Konfiguration halten.' }
              ]
            }
          ]
        },
        {
          label: 'Person 3 – Dynamik & Regeln',
          role: 'p3',
          meta: 'Sequenzen, Guards, Policies',
          children: [
            { label: 'Passwort-Policy erzwingen (Komplexität, Doppel-Eingabe, Sperre 3x/1h)', role: 'p3', meta: 'In Sequenz- und Aktivitätsdiagrammen als Guard/Decision modellieren (VL6, VL9).' },
            { label: 'Premium-Upgrade schaltet Rechnung + längere Reservierungen frei', role: 'p3', meta: 'Statuswechsel zeigen; Folgeschritte in S-02/S-06 markieren; Alternativpfad bei Fehlschlag.' },
            { label: 'Bewertungen nur für gekaufte Artikel und erst nach Terminende', role: 'p3', meta: 'Guard mit Termin- und Kaufprüfung; Fehlpfad skizzieren.' },
            { label: 'Digitale Bereitstellung: Tickets nur per E-Mail/Download/QR', role: 'p3', meta: 'Aktivität für Übergabe an S-04 modellieren; keine Papierzweige darstellen.' }
          ]
        },
        {
          label: 'Person 4 – Schnittstellen & Segmente',
          role: 'p4',
          meta: 'Segmente S-02..S-09 und externe Payment-Provider',
          children: [
            { label: 'S-09 Login & Passwortmanagement: Authentifizierung, Sperrlogik, Passwortvalidierung', role: 'p4', meta: 'Schnittstelle definieren: Sperrstatus/Passwortregeln konsumieren und liefern.' },
            { label: 'S-03 Bezahlung: Zahlungsarten + Validierungsstatus bereitstellen', role: 'p4', meta: 'API/Port spezifizieren: PaymentMethod-Liste mit Validierungsflags ausgeben.' },
            { label: 'S-06 Warenkorb: Kundentyp (Premium/Standard), Timeout 24h/36h, Checkout-Erlaubnis', role: 'p4', meta: 'Datenvertrag: premium-Flag, Timeout-Werte, Berechtigungsstatus liefern.' },
            { label: 'S-02 Sitzplatzauswahl: Reservierungsdauer 2h/4h nach Kundentyp', role: 'p4', meta: 'Reservierungsdauer als Parameter übergeben; Quelle ist reservierungsdauer()-Ableitung.' },
            { label: 'S-05 Kundenbewertung: Kaufnachweis + Terminprüfung für Freigabe', role: 'p4', meta: 'Berechtigungsservice bereitstellen (hatGekauft, terminVorbei) für S-05.' },
            { label: 'S-04 Ticketbereitstellung: E-Mail/Account als Übergabepunkt für Download und QR-Code', role: 'p4', meta: 'Lieferkanal definieren (E-Mail/Account); nur digitale Medien modellieren.' },
            { label: 'Externe Zahlungsanbieter: PayPal-Token, Karten-Token, SEPA-Mandat verwalten', role: 'p4', meta: 'Adapter/Ports ausarbeiten; Token-Speicherung und Mandatsstatus bereitstellen.' }
          ]
        }
      ]
    };

    const mindmapContainer = document.getElementById('mindmap');
    const legendContainer = document.getElementById('legend');

    function renderLegend() {
      legend.forEach(item => {
        const el = document.createElement('div');
        el.className = 'legend-item';
        const pill = document.createElement('span');
        pill.className = `pill ${roleStyles[item.role]}`;
        const label = document.createElement('span');
        label.textContent = item.label;
        el.appendChild(pill);
        el.appendChild(label);
        legendContainer.appendChild(el);
      });
    }

    function createNode(node, level = 0) {
      const wrap = document.createElement('div');
      wrap.className = 'node-wrap';

      const row = document.createElement('div');
      row.className = 'node';

      const hasChildren = node.children && node.children.length > 0;

      if (hasChildren) {
        const btn = document.createElement('button');
        btn.className = 'toggle';
        btn.textContent = level < 1 ? '▾' : '▸';
        btn.setAttribute('aria-label', level < 1 ? 'Einklappen' : 'Ausklappen');
        row.appendChild(btn);

        const box = document.createElement('div');
        box.className = `node-box ${roleStyles[node.role] || 'general'}`;
        const title = document.createElement('div');
        title.className = 'node-title';
        title.textContent = node.label;
        box.appendChild(title);
        if (node.meta) {
          const meta = document.createElement('div');
          meta.className = 'node-meta';
          meta.textContent = node.meta;
          box.appendChild(meta);
        }
        row.appendChild(box);
        wrap.appendChild(row);

        const childContainer = document.createElement('div');
        childContainer.className = 'children';
        childContainer.style.display = level < 1 ? 'block' : 'none';
        node.children.forEach((child) => childContainer.appendChild(createNode(child, level + 1)));
        wrap.appendChild(childContainer);

        btn.addEventListener('click', () => {
          const isOpen = childContainer.style.display !== 'none';
          childContainer.style.display = isOpen ? 'none' : 'block';
          btn.textContent = isOpen ? '▸' : '▾';
          btn.setAttribute('aria-label', isOpen ? 'Ausklappen' : 'Einklappen');
        });
      } else {
        const bullet = document.createElement('div');
        bullet.className = 'bullet';
        row.appendChild(bullet);

        const box = document.createElement('div');
        box.className = `node-box ${roleStyles[node.role] || 'general'}`;
        const title = document.createElement('div');
        title.className = 'node-title';
        title.textContent = node.label;
        box.appendChild(title);
        if (node.meta) {
          const meta = document.createElement('div');
          meta.className = 'node-meta';
          meta.textContent = node.meta;
          box.appendChild(meta);
        }
        row.appendChild(box);
        wrap.appendChild(row);
      }

      return wrap;
    }

    function renderMindmap() {
      mindmapContainer.innerHTML = '';
      mindmapContainer.appendChild(createNode(mindMapData));
    }

    renderLegend();
    renderMindmap();
  </script>
</body>
</html>
