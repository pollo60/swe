<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>S-01 Kundenverwaltung</title>
  <style>
    :root { --bg: #f7f9fc; --card: #ffffff; --border: #e5e7eb; --text: #1f2937; --muted: #4b5563; --general: #1f2937; --p1: #4f46e5; --p2: #059669; --p3: #f59e0b; --p4: #e11d48; }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: 'Segoe UI', Tahoma, sans-serif; background: radial-gradient(circle at 20% 20%, #f2f5ff 0%, #f7f9fc 35%, #eef2ff 100%); color: var(--text); }
    .page { min-height: 100vh; padding: 32px; }
    .container { max-width: 1400px; margin: 0 auto; display: grid; gap: 24px; }
    .card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; box-shadow: 0 10px 40px rgba(15, 23, 42, 0.08); padding: 24px; }
    h1 { margin: 0 0 8px 0; font-size: 28px; }
    h2 { margin: 0 0 12px 0; font-size: 20px; }
    p.lead { margin: 0; color: var(--muted); font-size: 14px; line-height: 1.6; }
    .header-info { background: linear-gradient(135deg, rgba(79, 70, 229, 0.06), rgba(5, 150, 105, 0.06)); border-left: 4px solid var(--p1); padding: 16px; border-radius: 12px; margin-top: 16px; }
    .legend { display: flex; flex-wrap: wrap; gap: 12px; margin-top: 16px; }
    .legend-item { display: flex; align-items: center; gap: 8px; font-size: 14px; color: var(--text); }
    .pill { height: 10px; width: 40px; border-radius: 999px; border: 1px solid rgba(0,0,0,0.08); }
    .p1 { background: var(--p1); color: #fff; border-color: #312e81; }
    .p2 { background: var(--p2); color: #fff; border-color: #065f46; }
    .p3 { background: var(--p3); color: #111827; border-color: #d97706; }
    .p4 { background: var(--p4); color: #fff; border-color: #9f1239; }
    .general { background: #1f2937; color: #fff; border-color: #0f172a; }
    
    /* Horizontal Layout für Hauptäste */
    .branches-container { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
    .branch-column { background: var(--card); border: 2px solid var(--border); border-radius: 16px; padding: 20px; box-shadow: 0 6px 24px rgba(0,0,0,0.06); }
    .branch-header { padding: 14px 18px; border-radius: 12px; margin-bottom: 16px; cursor: pointer; transition: transform 0.2s; }
    .branch-header:hover { transform: translateY(-2px); }
    .branch-title { font-weight: 700; font-size: 18px; margin: 0; }
    .branch-meta { font-size: 12px; margin: 6px 0 0 0; opacity: 0.9; line-height: 1.4; }
    .branch-content { display: none; }
    .branch-content.expanded { display: block; }
    
    /* Node-Styles für Kinder */
    .node-wrap { margin-left: 0; margin-bottom: 12px; }
    .node { display: flex; align-items: flex-start; gap: 10px; }
    .node-box { padding: 10px 14px; border-radius: 12px; border: 2px solid transparent; box-shadow: 0 4px 16px rgba(0,0,0,0.06); }
    .node-title { font-weight: 600; line-height: 1.3; font-size: 14px; }
    .node-meta { margin: 4px 0 0 0; font-size: 11px; opacity: 0.85; line-height: 1.4; }
    .children { border-left: 2px solid var(--border); margin-left: 18px; padding-left: 16px; margin-top: 8px; }
    .toggle { cursor: pointer; border: none; background: transparent; font-size: 14px; line-height: 1; padding: 4px; color: var(--muted); }
    .bullet { width: 6px; height: 6px; border-radius: 50%; background: #9ca3af; margin-top: 8px; flex-shrink: 0; }
    
    /* Bubble-Auflistung */
    .task-bubbles { display: flex; flex-wrap: wrap; gap: 10px; }
    .task-bubble { padding: 10px 16px; border-radius: 20px; font-size: 13px; font-weight: 500; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; border: 2px solid transparent; }
    .task-bubble:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.12); }
    
    @media (max-width: 1200px) {
      .branches-container { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="container">
      <!-- Header Card -->
      <div class="card">
        <h1>S-01 Kundenverwaltung</h1>
        <div class="header-info">
          <p class="lead"><strong>Aufgabenstellung:</strong> Fachliche Gliederung der Anforderungen für das Segment Kundenverwaltung im Online-Ticket-Shop</p>
          <p class="lead"><strong>Pflichtäste:</strong> Use Cases · Objekte und Attribute · Schnittstellen zu anderen Segmenten und externen Systemen</p>
          <p class="lead"><strong>Tools:</strong> Mindmapping mit XMind oder FreeMind · UML-Diagramme mit Visual Paradigm Community Edition</p>
        </div>
        <div class="legend" id="legend"></div>
      </div>

      <!-- Drei Hauptäste horizontal -->
      <div class="branches-container" id="branches"></div>

      <!-- Alle Aufgaben als Bubbles -->
      <div class="card">
        <h2>Alle Aufgaben im Überblick</h2>
        <div class="task-bubbles" id="taskBubbles"></div>
      </div>
    </div>
  </div>
  <script>
    const nodeIndex = new Map();
    const allTasks = [];
    const roleStyles = { general: 'general', p1: 'p1', p2: 'p2', p3: 'p3', p4: 'p4' };
    const legend = [
      { role: 'general', label: 'Aufgabenstellung / Neutral' },
      { role: 'p1', label: 'Use Cases & Stories' },
      { role: 'p2', label: 'Objekte & Attribute' },
      { role: 'p3', label: 'Dynamik & Regeln' },
      { role: 'p4', label: 'Schnittstellen & Segmente' }
    ];

    const mindMapData = {
      label: 'S-01 Kundenverwaltung',
      role: 'general',
      meta: 'Format: Mindmap; Tools: XMind/FreeMind',
      children: [
        { label: 'Use Cases', role: 'p1', meta: 'Alle Use Cases mit User Stories; Format: User Stories + UC-Spezifikationen; Tools: XMind/FreeMind + Visual Paradigm', children: [
          { label: 'UC: Registrierung & Login', role: 'p1', meta: 'Passwort-Policy, Sperrlogik; Schnittstelle zu S-09; Format: UC-Spezifikation + Aktivitätsdiagramm; Tools: XMind + Visual Paradigm', children: [
            { label: 'Als Besucher möchte ich mich registrieren, um Tickets kaufen zu können.', role: 'p1', meta: 'User Story; Akzeptanzkriterien: Benutzername, Passwort 2× eingeben' },
            { label: 'Als Kunde möchte ich mich anmelden, um auf Warenkorb zuzugreifen.', role: 'p1', meta: 'User Story; 3× falsches Passwort → 1h Sperre' },
            { label: 'Passwortregeln (Komplexität, doppelte Eingabe); Sperre nach 3 Fehlversuchen/1h', role: 'p3', meta: 'Policy-Details: Mindestlänge, Zeichen; Sperrlogik; Format: Aktivitätsdiagramm; Tool: Visual Paradigm' }
          ]},
          { label: 'UC: Profil & Kontaktdaten pflegen', role: 'p1', meta: 'Liefer-/Rechnungsadresse, nur digitale Zustellung (Anforderung für S-04); Format: UC-Spezifikation; Tool: XMind', children: [
            { label: 'Als Kunde möchte ich meine Kontakt- und Adressdaten pflegen.', role: 'p1', meta: 'User Story; E-Mail/Download/QR-Code (keine Papiertickets)' }
          ]},
          { label: 'UC: Zahlungswege verwalten', role: 'p1', meta: 'Zahlarten hinterlegen; Validierung IBAN/BIC/Luhn/Token; Schnittstelle zu S-03; Format: UC-Spezifikation + Aktivitätsdiagramm; Tools: XMind + Visual Paradigm', children: [
            { label: 'Als Kunde möchte ich meine Zahlungswege hinterlegen.', role: 'p1', meta: 'User Story; Vorkasse, Kreditkarte, PayPal, Bankeinzug; Premium: + Rechnung/Überweisung' },
            { label: 'Validierung aller Zahlungsdaten (IBAN/BIC/Luhn, Token, Mandat)', role: 'p3', meta: 'Akzeptanzkriterien für Validität; Format: Aktivitätsdiagramm; Tool: Visual Paradigm' }
          ]},
          { label: 'UC: Premium-Status nutzen', role: 'p1', meta: 'Premium-Upgrade; Reservierungsdauer 2h/4h; Warenkorb-Timeout 24h/36h; Schnittstellen zu S-02, S-06; Format: UC-Spezifikation; Tool: XMind', children: [
            { label: 'Als Kunde möchte ich Premium-Kunde werden, um längere Reservierungen (4h) zu nutzen.', role: 'p1', meta: 'User Story; Vorteile: 4h Reservierung, Warenkorb-Timeout 36h, + Rechnung/Überweisung' },
            { label: 'Reservierungsdauer und Warenkorb-Timeout übergeben', role: 'p3', meta: 'Parameter je Kundenstatus (Standard/Premium) an externe Segmente liefern; Format: Sequenzdiagramm; Tool: Visual Paradigm' }
          ]},
          { label: 'UC: Artikel bewerten', role: 'p1', meta: 'Bewertung nur für gekaufte Artikel nach Terminende; Schnittstelle zu S-05; Format: UC-Spezifikation + Aktivitätsdiagramm; Tools: XMind + Visual Paradigm', children: [
            { label: 'Als Kunde möchte ich gekaufte Artikel bewerten.', role: 'p1', meta: 'User Story; nur gekaufte Artikel, erst nach Terminende, Shop nicht bewertbar' },
            { label: 'Kaufnachweis & Terminprüfung (Guard); Shop-Bewertungen ausgeschlossen', role: 'p3', meta: 'Berechtigungsprüfung mit S-05; Guard-Bedingungen; Format: Aktivitätsdiagramm; Tool: Visual Paradigm' }
          ]}
        ]},
        { label: 'Objekte und Attribute', role: 'p2', meta: 'Klassendiagramm, Datenstruktur, Ableitungen; Format: UML-Klassendiagramm; Tool: Visual Paradigm', children: [
          { label: 'Kunde (zentral)', role: 'p2', meta: 'Basis-Entity mit Ableitungen Standard/Premium; Format: UML-Klassendiagramm (Vererbung); Tool: Visual Paradigm', children: [
            { label: 'Attribute: Name, Kontaktdaten, Status, Registrierungsdatum', role: 'p2', meta: 'Datentypen (String, Email, Date), Constraints (NOT NULL, UNIQUE)' },
            { label: 'Ableitung: Standardkunde, Premium-Kunde (Upgrade-Datum)', role: 'p2', meta: 'Generalisierung/Spezialisierung' }
          ]},
          { label: 'Adresse', role: 'p2', meta: 'Trennung Liefer-/Rechnungsadresse; Format: UML-Klassendiagramm (Aggregation); Tool: Visual Paradigm', children: [
            { label: 'Attribute: Straße, PLZ, Ort, Land, Typ (Liefer-/Rechnungsadresse)', role: 'p2', meta: 'Assoziationsvielfalt (Kunde 1 zu N Adressen)' }
          ]},
          { label: 'Zahlungsweg', role: 'p2', meta: 'Basis-Entity mit Ableitungen pro Zahlungsart; Format: UML-Klassendiagramm (Vererbung); Tool: Visual Paradigm', children: [
            { label: 'Ableitungen: Vorkasse, Kreditkarte, PayPal, Bankeinzug, Rechnung', role: 'p2', meta: 'Generalisierung → Spezialisierung' },
            { label: 'Attribute je Zahlart: IBAN/BIC, Kartentoken, PayPal-ID, Mandatsreferenz', role: 'p2', meta: 'Constraints (UNIQUE, verschlüsselte Speicherung)' }
          ]},
          { label: 'Reservierungsparameter', role: 'p2', meta: 'Abgeleitet aus Kundenstatus; Format: UML-Klassendiagramm; Tool: Visual Paradigm', children: [
            { label: 'Attribute: Dauer (2h/4h), Warenkorb-Timeout (24h/36h)', role: 'p2', meta: 'Verwendung in Schnittstellen zu S-02/S-06' }
          ]}
        ]},
        { label: 'Schnittstellen zu anderen Segmenten und externen Systemen', role: 'p4', meta: 'Übersicht Schnittstellenaufrufe; Format: Sequenzdiagramme; Tool: Visual Paradigm', children: [
          { label: 'S-02 Sitzplatzauswahl', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Parameter: Reservierungsdauer (2h Standard / 4h Premium)', role: 'p4', meta: 'S-01 liefert Reservierungsdauer an S-02' }
          ]},
          { label: 'S-03 Bezahlung', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Parameter: Zahlungsweg-Objekt (IBAN, Card-Token, PayPal-ID, Mandat)', role: 'p4', meta: 'S-01 liefert validiertes Zahlungsweg-Objekt an S-03' }
          ]},
          { label: 'S-04 Ticketbereitstellung', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Anforderung: Nur digitale Zustellung (E-Mail/Download/QR)', role: 'p4', meta: 'S-01 gibt vor: keine Papiertickets, nur digitale Kanäle' }
          ]},
          { label: 'S-05 Kundenbewertung', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Guard: Kaufnachweis + Terminende (erst danach Bewertung)', role: 'p4', meta: 'S-01 liefert Kaufhistorie an S-05' },
            { label: 'Ausschluss: Shop selbst nicht bewertbar', role: 'p4', meta: 'Geschäftsregel aus Aufgabenstellung' }
          ]},
          { label: 'S-06 Warenkorb', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Parameter: Warenkorb-Timeout (24h Standard / 36h Premium)', role: 'p4', meta: 'S-01 liefert Timeout-Dauer an S-06' }
          ]},
          { label: 'S-09 Zentrales Login/Passwort-Management', role: 'p4', meta: 'Externe Gruppe; Format: Sequenzdiagramm; Tool: Visual Paradigm', children: [
            { label: 'Policy: Passwort-Regeln (Komplexität, doppelte Eingabe, Sperre 3×/1h)', role: 'p4', meta: 'S-01 nutzt S-09 für Passwort-Validierung und Sperrlogik' }
          ]}
        ]}
      ]
    };

    function renderLegend() {
      legend.forEach(item => {
        const el = document.createElement('div');
        el.className = 'legend-item';
        const pill = document.createElement('span');
        pill.className = `pill ${roleStyles[item.role]}`;
        const label = document.createElement('span');
        label.textContent = item.label;
        el.appendChild(pill);
        el.appendChild(label);
        document.getElementById('legend').appendChild(el);
      });
    }

    function collectTasks(node) {
      if (node.label && node.role) {
        allTasks.push({ label: node.label, role: node.role });
      }
      if (node.children) {
        node.children.forEach(child => collectTasks(child));
      }
    }

    function renderBranches() {
      const container = document.getElementById('branches');
      mindMapData.children.forEach(branch => {
        const col = document.createElement('div');
        col.className = 'branch-column';
        
        const header = document.createElement('div');
        header.className = `branch-header ${roleStyles[branch.role]}`;
        header.innerHTML = `<div class="branch-title">${branch.label}</div><div class="branch-meta">${branch.meta || ''}</div>`;
        
        const content = document.createElement('div');
        content.className = 'branch-content';
        
        if (branch.children) {
          branch.children.forEach(child => {
            const childNode = createNode(child, 0);
            content.appendChild(childNode);
          });
        }
        
        header.addEventListener('click', () => {
          content.classList.toggle('expanded');
        });
        
        col.appendChild(header);
        col.appendChild(content);
        container.appendChild(col);
      });
    }

    function createNode(node, level = 0) {
      const wrap = document.createElement('div');
      wrap.className = 'node-wrap';
      const nodeEl = document.createElement('div');
      nodeEl.className = 'node';
      
      let toggle;
      const childContainer = document.createElement('div');
      childContainer.className = 'children';
      childContainer.style.display = 'none';
      
      if (node.children && node.children.length > 0) {
        toggle = document.createElement('button');
        toggle.className = 'toggle';
        toggle.textContent = '▶';
        toggle.addEventListener('click', () => {
          if (childContainer.style.display === 'none') {
            childContainer.style.display = 'block';
            toggle.textContent = '▼';
          } else {
            childContainer.style.display = 'none';
            toggle.textContent = '▶';
          }
        });
        nodeEl.appendChild(toggle);
      } else {
        const bullet = document.createElement('span');
        bullet.className = 'bullet';
        nodeEl.appendChild(bullet);
      }
      
      const boxEl = document.createElement('div');
      boxEl.className = `node-box ${roleStyles[node.role] || 'general'}`;
      const title = document.createElement('div');
      title.className = 'node-title';
      title.textContent = node.label;
      boxEl.appendChild(title);
      if (node.meta) {
        const meta = document.createElement('p');
        meta.className = 'node-meta';
        meta.textContent = node.meta;
        boxEl.appendChild(meta);
      }
      nodeEl.appendChild(boxEl);
      wrap.appendChild(nodeEl);
      
      if (node.children && node.children.length > 0) {
        node.children.forEach(child => {
          const childNode = createNode(child, level + 1);
          childContainer.appendChild(childNode);
        });
        wrap.appendChild(childContainer);
      }
      
      return wrap;
    }

    function renderTaskBubbles() {
      const container = document.getElementById('taskBubbles');
      allTasks.forEach(task => {
        const bubble = document.createElement('div');
        bubble.className = `task-bubble ${roleStyles[task.role]}`;
        bubble.textContent = task.label;
        container.appendChild(bubble);
      });
    }

    collectTasks(mindMapData);
    renderLegend();
    renderBranches();
    renderTaskBubbles();
  </script>
</body>
</html>
